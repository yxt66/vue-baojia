(function(){var e={6703:function(e,t,n){"use strict";var r=n(6369),o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app"},[t("input",{attrs:{type:"file"},on:{change:e.onChange}}),t("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出excel")]),e.excelData.results?t("el-table",{staticStyle:{width:"95%",margin:"10px"},attrs:{data:[...e.excelData.results],border:"","highlight-current-row":""}},[e._l(e.excelData.header,(function(n){return t("el-table-column",{key:n,attrs:{align:"center",prop:n,label:n},scopedSlots:e._u([{key:"default",fn:function({row:r,index:o}){return[r.edit&&"序号"!==n?t("el-input",{attrs:{placeholder:""},model:{value:r[n],callback:function(t){e.$set(r,n,t)},expression:"row[item]"}}):t("span",[e._v(e._s(r[n]))])]}}],null,!0)})})),t("el-table-column",{attrs:{"header-align":"center",align:"center",prop:"",label:"操作"},scopedSlots:e._u([{key:"default",fn:function({row:n}){return[n.edit?t("el-button",{attrs:{type:"success",size:"medium"},on:{click:function(t){return e.save(n)}}},[e._v("保存")]):t("el-button",{attrs:{type:"warning",size:"medium"},on:{click:function(e){n.edit=!0}}},[e._v("修改")]),n.edit?t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){n.edit=!1}}},[e._v("取消")]):e._e()]}}],null,!1,1845239221)})],2):e._e()],1)},l=[],a=(n(7658),n(9325)),i=n.n(a),u={name:"app",data(){return{excelData:{header:null,results:null}}},methods:{async onChange(e){await this.readerExcel(e.target.files[0])},generateData({header:e,results:t}){this.excelData.header=e,this.excelData.results=t.map((e=>(this.$set(e,"edit",!1),e)))},readerExcel(e){return new Promise(((t,n)=>{const r=new FileReader;r.readAsArrayBuffer(e),r.onload=e=>{const t=e.target.result,n=i().read(t,{type:"array"});console.log(n);const r=n.SheetNames[0],o=n.Sheets[r],l=this.getHeaderRow(o);console.log(r),console.log(o),console.log(o["!merges"]),console.log(l);const a=i().utils.sheet_to_json(o);console.log(a),this.generateData({header:l,results:a})}}))},getHeaderRow(e){let t=[];const n=i().utils.decode_range(e["!ref"]);let r;console.log(n);const o=n.s.r;for(r=n.s.c;r<=n.e.c;++r){const n=e[i().utils.encode_cell({c:r,r:o})];let l="UNKNOWN "+r;n&&n.t&&(l=i().utils.format_cell(n)),t.push(l)}return t=t.filter((e=>!e.includes("UNKNOWN"))),t},exportExcel(){let e=i().utils.json_to_sheet(this.excelData.results.map((e=>{const{edit:t,...n}=e;return n}))),t=i().utils.book_new();i().utils.book_append_sheet(t,e,"11月份"),i().writeFile(t,`${(new Date).getTime()}.xlsx`)},save(e){e.edit=!1,this.$message.success("保存成功")}}},s=u,c=n(1001),f=(0,c.Z)(s,o,l,!1,null,null,null),d=f.exports,p=n(8499),h=n.n(p);r["default"].use(h()),r["default"].config.productionTip=!1,new r["default"]({render:e=>e(d)}).$mount("#app")},5382:function(){},2095:function(){},1219:function(){}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var l=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,r,o,l){if(!r){var a=1/0;for(c=0;c<e.length;c++){r=e[c][0],o=e[c][1],l=e[c][2];for(var i=!0,u=0;u<r.length;u++)(!1&l||a>=l)&&Object.keys(n.O).every((function(e){return n.O[e](r[u])}))?r.splice(u--,1):(i=!1,l<a&&(a=l));if(i){e.splice(c--,1);var s=o();void 0!==s&&(t=s)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[r,o,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,l,a=r[0],i=r[1],u=r[2],s=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(u)var c=u(n)}for(t&&t(r);s<a.length;s++)l=a[s],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(c)},r=self["webpackChunkvue_baojia"]=self["webpackChunkvue_baojia"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(6703)}));r=n.O(r)})();
//# sourceMappingURL=app.f0ce6603.js.map